<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>orutego - Distance & Time Metrics</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
    <script>
        // Google Maps API callback function
        function initMap() {
            window.mapInitialized = true;
            if (window.orutegoApp) {
                window.orutegoApp.initializeGoogleMaps();
            }
        }
    </script>
</head>

<body class="min-h-screen bg-gradient">
    <div class="container">
        <!-- Header -->


        <div class="main-layout">
            <!-- Left Panel - Controls -->
            <div class="panel-left slide-in-left">
                <div class="card">
                    <!-- Header -->
                    <header class="header fade-in header-box">
                        <h1 class="header-title">ðŸ§­ orutego</h1>
                        <p class="header-subtitle">Distance & Time Metrics</p>
                    </header>

                    <!-- Navigation Tabs -->
                    <div class="nav-tabs">
                        <button class="nav-tab active" data-tab="single">Route</button>
                        <button class="nav-tab" data-tab="mass">Mass Search</button>
                    </div>

                    <!-- API Key Section -->
                    <div class="section">
                        <h3 class="section-title">
                            <i class="fas fa-key"></i>
                            Google Maps API Key
                        </h3>
                        <div class="input-group">
                            <div class="input-container">
                                <input type="password" id="apiKey" placeholder="Enter your Google Maps API Key"
                                    class="input-field" />
                                <button type="button" id="toggleApiKey" class="toggle-btn">
                                    <i class="fas fa-eye" id="eyeIcon"></i>
                                </button>
                            </div>
                            <button id="saveApiKey" class="btn btn-outline">Save</button>
                        </div>
                        <div id="apiKeyStatus" class="status-message"></div>
                    </div>

                    <!-- Single Route Mode -->
                    <div id="singleRouteMode">
                        <!-- Address Inputs -->
                        <div class="section">
                            <h3 class="section-title">
                                <i class="fas fa-map-marker-alt"></i>
                                Addresses
                            </h3>

                            <div class="address-inputs">
                                <div class="address-inputs-column">
                                    <div class="input-with-icon">
                                        <i class="fas fa-map-marker-alt text-green"></i>
                                        <input type="text" id="origin" placeholder="Origin address"
                                            class="input-field" />
                                    </div>

                                    <div class="input-with-icon">
                                        <i class="fas fa-map-marker-alt text-red"></i>
                                        <input type="text" id="destination" placeholder="Destination address"
                                            class="input-field" />
                                    </div>
                                </div>

                                <div class="swap-container-side">
                                    <button id="swapAddresses" class="btn-swap" title="Swap addresses">
                                        <i class="fas fa-arrows-up-down"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Travel Mode -->
                        <div class="section">
                            <h3 class="section-title">
                                <i class="fas fa-route"></i>
                                Travel Mode
                            </h3>
                            <div class="travel-modes">
                                <button class="travel-mode active" data-mode="driving">
                                    <i class="fas fa-car"></i>
                                    Driving
                                </button>
                                <button class="travel-mode" data-mode="walking">
                                    <i class="fas fa-walking"></i>
                                    Walking
                                </button>
                                <button class="travel-mode" data-mode="bicycling">
                                    <i class="fas fa-bicycle"></i>
                                    Cycling
                                </button>
                                <button class="travel-mode" data-mode="transit">
                                    <i class="fas fa-bus"></i>
                                    Transit
                                </button>
                            </div>
                        </div>

                        <!-- Calculate Button -->
                        <button id="calculateBtn" class="btn btn-primary btn-large">
                            <i class="fas fa-calculator"></i>
                            <span id="calculateText">Calculate Route</span>
                        </button>
                    </div>

                    <!-- Mass Search Mode (Hidden by default) -->
                    <div id="massSearchMode" class="hidden">
                        <div class="section">
                            <h3 class="section-title">
                                <i class="fas fa-list"></i>
                                Bulk Address Search
                            </h3>
                            <p class="text-sm text-gray margin-bottom-sm">Enter addresses (one per line):</p>
                            <textarea id="massInput" class="input-field textarea-field" rows="8"
                                placeholder="Enter addresses here, one per line..."></textarea>
                            <div class="address-count" id="addressCount">0 addresses</div>
                        </div>

                        <button id="massGeocodeBtn" class="btn btn-primary btn-large">
                            <i class="fas fa-search-location"></i>
                            <span id="massGeocodeText">Process Addresses</span>
                        </button>
                    </div>

                    <!-- Error Display -->
                    <div id="errorMessage" class="error-message"></div>
                </div>
            </div>

            <!-- Right Panel - Results -->
            <div class="panel-right slide-in-right">
                <button id="closeExpandedBtn" class="btn-close-expanded hidden" title="Close expanded view">
                    <i class="fas fa-times"></i>
                </button>
                <div class="card">
                    <h3 class="section-title">
                        <i class="fas fa-compass"></i>
                        Calculated Metrics
                    </h3>

                    <!-- Single Route Results -->
                    <div id="resultsContainer">
                        <div id="noResults" class="no-results">
                            <i class="fas fa-compass compass-icon"></i>
                            <p>Enter addresses and calculate to see results</p>
                        </div>

                        <div id="resultsContent" class="results-content hidden">
                            <div class="results-grid">
                                <div class="result-card card-teal">
                                    <div class="result-label">Distance</div>
                                    <div id="distanceValue" class="result-value">0 km</div>
                                </div>
                                <div class="result-card card-cyan">
                                    <div class="result-label">
                                        <i class="fas fa-clock"></i>
                                        Duration
                                    </div>
                                    <div id="durationValue" class="result-value">00:00</div>
                                    <div id="decimalHoursValue" class="result-decimal">0h decimal</div>
                                </div>
                            </div>

                            <div class="coordinate-data">
                                <div class="coordinate-label">Coordinate Data:</div>
                                <div class="coordinate-container">
                                    <code id="coordinateOutput" class="coordinate-output"></code>
                                    <button id="copyBtn" class="copy-btn" title="Copy to clipboard">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                <p class="format-description">Comma Style: Origin Latitude, Origin Longitude,
                                    Destination Latitude, Destination Longitude, Distance, Duration, Decimal Hours</p>
                                <div id="copyStatus" class="copy-status"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Mass Search Results -->
                    <div id="massResultsContainer" class="hidden">
                        <div id="massResultsContent" class="results-content">
                            <div class="results-toolbar">
                                <div class="results-count" id="massResultsCount">0 results</div>
                                <button id="copyMassResultsBtn" class="btn-small btn-outline">
                                    <i class="fas fa-copy"></i> Copy All (CSV)
                                </button>
                            </div>

                            <div class="table-container">
                                <table class="results-table" id="massResultsTable">
                                    <thead>
                                        <tr>
                                            <th>Address</th>
                                            <th>Latitude</th>
                                            <th>Longitude</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Rows generated by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map Section -->
                <div class="map-section slide-in-up">
                    <div class="card">
                        <h3 class="section-title">Route Map</h3>
                        <div class="map-container">
                            <div id="googleMap"></div>
                            <div id="mapPlaceholder" class="map-placeholder">
                                <i class="fas fa-map map-icon"></i>
                                <p>Route will be displayed here after calculation</p>
                                <p class="map-loading">Loading Google Maps...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <i class="fas fa-calculator spinning"></i>
            <p>Calculating route...</p>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

    <!-- Google Maps API will be loaded dynamically by JavaScript -->
    <div id="googleMapsApiStatus" style="display: none;"></div>
</body>

</html>